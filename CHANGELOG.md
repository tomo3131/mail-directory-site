# é–‹ç™ºè¨˜éŒ² (Development Log)

## 2025-11-11 - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ— & Supabaseçµ±åˆå®Œäº†

### ğŸ“‹ å®Ÿè£…ã—ãŸæ©Ÿèƒ½

#### 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ æ§‹ç¯‰
- Next.js 14 (App Router) + TypeScript + Tailwind CSS
- shadcn/ui ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆçµ±åˆ
- é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Œäº†

#### 2. Supabaseãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹ç¯‰
- **æ¥ç¶šæƒ…å ±è¨­å®š**: Supabase URL & Anon Keyã‚’ç’°å¢ƒå¤‰æ•°ã«è¨­å®š
- **ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ**: 7ã¤ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆ
  - `categories` (5ä»¶) - ã‚«ãƒ†ã‚´ãƒªãƒã‚¹ã‚¿
  - `brands` (6ä»¶) - ãƒ–ãƒ©ãƒ³ãƒ‰æƒ…å ±
  - `emails` (5ä»¶) - ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–
  - `users` - ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ï¼ˆæœªä½¿ç”¨ï¼‰
  - `collections` - ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ï¼ˆæœªä½¿ç”¨ï¼‰
  - `collection_emails` - ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ç´ä»˜ã‘ï¼ˆæœªä½¿ç”¨ï¼‰
  - `keyword_alerts` - ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚¢ãƒ©ãƒ¼ãƒˆï¼ˆæœªä½¿ç”¨ï¼‰

#### 3. åˆæœŸãƒ‡ãƒ¼ã‚¿æŠ•å…¥
**ã‚«ãƒ†ã‚´ãƒªï¼ˆ5ä»¶ï¼‰:**
- ã‚¢ãƒ‘ãƒ¬ãƒ« (apparel)
- ã‚³ã‚¹ãƒ¡ãƒ»ç¾å®¹ (beauty)
- å®¶é›» (electronics)
- é£Ÿå“ãƒ»é£²æ–™ (food)
- ç·åˆEC (marketplace)

**ãƒ–ãƒ©ãƒ³ãƒ‰ï¼ˆ6ä»¶ï¼‰:**
- ãƒ¦ãƒ‹ã‚¯ãƒ­ (uniqlo) - 245é€š
- æ¥½å¤©å¸‚å ´ (rakuten) - 520é€š
- Amazon Japan (amazon) - 680é€š
- ç„¡å°è‰¯å“ (muji) - 180é€š
- ZOZOTOWN (zozotown) - 320é€š
- ãƒ¨ãƒ‰ãƒã‚·ã‚«ãƒ¡ãƒ© (yodobashi) - 290é€š

**ãƒ¡ãƒ¼ãƒ«ï¼ˆ5ä»¶ï¼‰:**
- ãƒ¦ãƒ‹ã‚¯ãƒ­: é€±æœ«é™å®šãƒ’ãƒ¼ãƒˆãƒ†ãƒƒã‚¯ã‚»ãƒ¼ãƒ«
- æ¥½å¤©å¸‚å ´: ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚»ãƒ¼ãƒ«ï¼ˆãƒã‚¤ãƒ³ãƒˆæœ€å¤§44å€ï¼‰
- Amazon: ãƒ–ãƒ©ãƒƒã‚¯ãƒ•ãƒ©ã‚¤ãƒ‡ãƒ¼å…ˆè¡Œã‚»ãƒ¼ãƒ«
- ç„¡å°è‰¯å“: å†¬ã®ã‚ã£ãŸã‹ã‚¤ãƒ³ãƒŠãƒ¼ç‰¹é›†
- ZOZOTOWN: ZOZOWEEKäººæ°—ãƒ–ãƒ©ãƒ³ãƒ‰ã‚»ãƒ¼ãƒ«

#### 4. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…

**å®Ÿè£…ãƒšãƒ¼ã‚¸:**
- `/` - ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸ï¼ˆDirect Response Marketingæ‰‹æ³•ï¼‰
- `/brands` - ãƒ–ãƒ©ãƒ³ãƒ‰ä¸€è¦§ãƒšãƒ¼ã‚¸ï¼ˆ6ãƒ–ãƒ©ãƒ³ãƒ‰è¡¨ç¤ºï¼‰
- `/brands/[slug]` - ãƒ–ãƒ©ãƒ³ãƒ‰è©³ç´°ãƒšãƒ¼ã‚¸ï¼ˆãƒ¡ãƒ¼ãƒ«ä¸€è¦§ï¼‰
- `/emails/[id]` - ãƒ¡ãƒ¼ãƒ«è©³ç´°ãƒšãƒ¼ã‚¸ï¼ˆHTMLè¡¨ç¤º + é–²è¦§æ•°ã‚«ã‚¦ãƒ³ãƒˆï¼‰

**ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ­ã‚¸ãƒƒã‚¯:**
- `src/lib/supabase.ts` - Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–
- `src/lib/supabase-server.ts` - ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ‡ãƒ¼ã‚¿å–å¾—é–¢æ•°
  - `getAllBrands()` - å…¨ãƒ–ãƒ©ãƒ³ãƒ‰å–å¾—
  - `getBrandBySlug(slug)` - slugæŒ‡å®šã§ãƒ–ãƒ©ãƒ³ãƒ‰å–å¾—
  - `getEmailsByBrand(brandId, limit?)` - ãƒ–ãƒ©ãƒ³ãƒ‰åˆ¥ãƒ¡ãƒ¼ãƒ«å–å¾—
  - `getEmailById(id)` - ãƒ¡ãƒ¼ãƒ«è©³ç´°å–å¾—ï¼ˆé–²è¦§æ•°+1ï¼‰
  - `getCategories()` - ã‚«ãƒ†ã‚´ãƒªä¸€è¦§å–å¾—
  - `searchEmails(query)` - ãƒ¡ãƒ¼ãƒ«æ¤œç´¢ï¼ˆæœªä½¿ç”¨ï¼‰

**ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å¯¾ç­–:**
- ISR (Incremental Static Regeneration): `revalidate = 60` (60ç§’ã”ã¨ã«å†æ¤œè¨¼)
- Server Componentsä½¿ç”¨ï¼ˆã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ï¼‰
- Promise.all()ã«ã‚ˆã‚‹ä¸¦åˆ—ãƒ‡ãƒ¼ã‚¿å–å¾—

### ğŸ› ä¿®æ­£ã—ãŸãƒã‚°

#### 1. æ—¥æœ¬èªå…¨æ–‡æ¤œç´¢ã‚¨ãƒ©ãƒ¼
- **å•é¡Œ**: PostgreSQLã«`japanese`æ¤œç´¢è¨­å®šãŒå­˜åœ¨ã—ãªã„
- **ã‚¨ãƒ©ãƒ¼**: `text search configuration 'japanese' does not exist`
- **ä¿®æ­£**: `database/01_create_tables_fixed.sql`ã§æ—¥æœ¬èªå…¨æ–‡æ¤œç´¢ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ

#### 2. Next.js 15+ params Promiseå¤‰æ›´
- **å•é¡Œ**: Next.js 15ä»¥é™ã€å‹•çš„ãƒ«ãƒ¼ãƒˆã®`params`ãŒPromiseã«ãªã£ãŸ
- **ã‚¨ãƒ©ãƒ¼**: `Route "/brands/[slug]" used params.slug. params is a Promise and must be unwrapped`
- **ä¿®æ­£ç®‡æ‰€**:
  - `src/app/brands/[slug]/page.tsx:13-15`
  - `src/app/emails/[id]/page.tsx:13-15`
- **ä¿®æ­£å†…å®¹**:
  ```typescript
  // Before
  params: { slug: string }
  const brand = await getBrandBySlug(params.slug);

  // After
  params: Promise<{ slug: string }>
  const { slug } = await params;
  const brand = await getBrandBySlug(slug);
  ```

### ğŸ“Š ç¾åœ¨ã®çŠ¶æ…‹

**âœ… å‹•ä½œç¢ºèªæ¸ˆã¿:**
- ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸: http://localhost:3000
- ãƒ–ãƒ©ãƒ³ãƒ‰ä¸€è¦§: http://localhost:3000/brands
- ãƒ–ãƒ©ãƒ³ãƒ‰è©³ç´°: http://localhost:3000/brands/amazon
- ãƒ¡ãƒ¼ãƒ«è©³ç´°: å„ãƒ¡ãƒ¼ãƒ«ã¸ã®ãƒªãƒ³ã‚¯ã‹ã‚‰é·ç§»å¯èƒ½

**ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š:**
- Supabase URL: https://lzuirlmntpazjlkxwoec.supabase.co
- èªè¨¼: Anon Keyä½¿ç”¨
- å…¨ãƒšãƒ¼ã‚¸ã§Supabaseã‹ã‚‰ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿å–å¾—

**ã‚³ã‚¹ãƒˆ:**
- Supabase Free Tier: $0/æœˆ
- Vercel Hobby Plan (ãƒ‡ãƒ—ãƒ­ã‚¤äºˆå®š): $0/æœˆ

### ğŸš§ æœªå®Ÿè£…æ©Ÿèƒ½ï¼ˆMVPè¦ä»¶ï¼‰

#### å„ªå…ˆåº¦: é«˜
- [ ] æ¤œç´¢æ©Ÿèƒ½ (`/search`)
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ï¼ˆã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—/ãƒ­ã‚°ã‚¤ãƒ³ï¼‰
- [ ] Stripeæ±ºæ¸ˆçµ±åˆï¼ˆÂ¥9,800/æœˆãƒ—ãƒ­ãƒ—ãƒ©ãƒ³ï¼‰

#### å„ªå…ˆåº¦: ä¸­
- [ ] ãƒ¡ãƒ¼ãƒ«è‡ªå‹•å–å¾—æ©Ÿèƒ½ï¼ˆGmail APIé€£æºï¼‰
- [ ] ãƒ–ãƒ©ãƒ³ãƒ‰ãƒ•ã‚©ãƒ­ãƒ¼æ©Ÿèƒ½
- [ ] ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³æ©Ÿèƒ½
- [ ] ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚¢ãƒ©ãƒ¼ãƒˆæ©Ÿèƒ½

#### å„ªå…ˆåº¦: ä½
- [ ] ç®¡ç†ç”»é¢ï¼ˆãƒ–ãƒ©ãƒ³ãƒ‰ãƒ»ãƒ¡ãƒ¼ãƒ«ç®¡ç†ï¼‰
- [ ] åˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- [ ] APIæä¾›æ©Ÿèƒ½

### ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ 

```
mail-directory-site/
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx              # ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸
â”‚   â”‚   â”‚   â”œâ”€â”€ brands/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx          # ãƒ–ãƒ©ãƒ³ãƒ‰ä¸€è¦§
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ [slug]/page.tsx   # ãƒ–ãƒ©ãƒ³ãƒ‰è©³ç´°
â”‚   â”‚   â”‚   â””â”€â”€ emails/
â”‚   â”‚   â”‚       â””â”€â”€ [id]/page.tsx     # ãƒ¡ãƒ¼ãƒ«è©³ç´°
â”‚   â”‚   â”œâ”€â”€ components/ui/            # shadcn/ui ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â””â”€â”€ lib/
â”‚   â”‚       â”œâ”€â”€ supabase.ts           # Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚   â”‚       â””â”€â”€ supabase-server.ts    # ãƒ‡ãƒ¼ã‚¿å–å¾—é–¢æ•°
â”‚   â”œâ”€â”€ .env.local                    # ç’°å¢ƒå¤‰æ•°ï¼ˆgitignoreï¼‰
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ 01_create_tables_fixed.sql    # ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©
â”‚   â””â”€â”€ 02_seed_data.sql              # åˆæœŸãƒ‡ãƒ¼ã‚¿
â”œâ”€â”€ .env.example                      # ç’°å¢ƒå¤‰æ•°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â”œâ”€â”€ README.md                         # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦
â”œâ”€â”€ DEPLOYMENT_GUIDE.md               # ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †
â””â”€â”€ CHANGELOG.md                      # æœ¬ãƒ•ã‚¡ã‚¤ãƒ«
```

### ğŸ”§ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

**ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰:**
- Next.js 14 (App Router)
- TypeScript
- Tailwind CSS 3.x
- shadcn/ui

**ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰:**
- Supabase (PostgreSQL + Auth + Storage)
- Next.js API Routes (å°†æ¥çš„ã«ä½¿ç”¨)

**ã‚¤ãƒ³ãƒ•ãƒ©:**
- Vercel (äºˆå®š)
- Supabase Cloud

**é–‹ç™ºãƒ„ãƒ¼ãƒ«:**
- GitHub CLI
- npm
- VSCode (æ¨å¥¨)

### ğŸ“ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **æ¤œç´¢æ©Ÿèƒ½å®Ÿè£…** - `/search`ãƒšãƒ¼ã‚¸ä½œæˆ
2. **èªè¨¼æ©Ÿèƒ½** - Supabase Authçµ±åˆ
3. **Stripeçµ±åˆ** - ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³æ±ºæ¸ˆ
4. **Vercelãƒ‡ãƒ—ãƒ­ã‚¤** - æœ¬ç•ªç’°å¢ƒå…¬é–‹
5. **ãƒ¡ãƒ¼ãƒ«å–å¾—è‡ªå‹•åŒ–** - Gmail APIé€£æº

### ğŸ‘¥ é–‹ç™ºè€…

- Claude Code (AIé–‹ç™ºã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ)
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚ªãƒ¼ãƒŠãƒ¼: @akkin

### ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

æœªå®šï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚ªãƒ¼ãƒŠãƒ¼ãŒæ±ºå®šï¼‰
